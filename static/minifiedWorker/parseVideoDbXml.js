onmessage=a=>{const b=new FileReaderSync,c=b.readAsText(a.data),d=new RegExp(/<\/?videodb>|<\/?movie>|<\/?title>|<\/?id>|<\/?originaltitle>|<\/?year>|<\/?set>|<\/?tagline>|<\/?genre>|<\/?art>|<\/?fanart>|<\/?poster>|<\/?runtime>|<\/?mpaa>|<\/?playcount>/),f=new RegExp(/<\/?tvshow>/);let g=Number.POSITIVE_INFINITY;const h=/&apos;/,i=new RegExp(h),j=c.split("\n").map((o,p)=>{return d.exec(o)&&p<g?i.exec(o)?o.replace(h,"'"):o:void(f.exec(o)&&(g=p))}).concat("</videodb>").join("\n");importScripts("/static/minifiedWorker/xmlsax.js");let k={},l="";SAXEventHandler.prototype.startElement=function(o){l=o},SAXEventHandler.prototype.characters=function(o,p,q){const r=o.substr(p,q);return 0>=r.trim().length?void 0:"genre"===l?(k.genre||(k.genre=[]),void k.genre.push(r)):void(k[l]=r)},SAXEventHandler.prototype.endElement=function(o){"movie"===o&&postMessage({imdbId:k.id,title:k.title,originaltitle:k.originaltitle,year:k.year,set:k.set,tagline:k.tagline,genre:k.genre,fanart:k.fanart,poster:k.poster,runtime:k.runtime,mpaa:k.mpaa,watched:0<Number.parseInt(k.playcount)})},SAXEventHandler.prototype.endDocument=function(){postMessage({event:"finished"})};const m=new SAXDriver,n=new SAXEventHandler;m.setDocumentHandler(n),m.setLexicalHandler(n),m.setErrorHandler(n),m.parse(j)};